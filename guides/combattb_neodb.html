<article class="guide">
  <carousel class="deck container-fluid">
    <slide class="row-fluid">
      <div class="col-sm-2">
        <div class="imageblock">
          <div class="content">
            <img
              src="http://localhost:7474/guides/logo.png"
              alt="NeoDB graph model"
            />
          </div>
        </div>
      </div>
      <div class="col-sm-10">
        <h3>
          <a
            href="https://combattb.org"
            target="_blank"
            rel="”noopener"
            noreferrer”
            >COMBAT-TB</a
          >
          NeoDB: fostering Tuberculosis research through integrative analysis
          using graph database technologies
        </h3>
        <br />
        <div class="paragraph">
          <p class="lead">
            NeoDB is a free and open source integrated M.tuberculosis ‘omics’
            knowledge-base. NeoDB is based on Neo4j and enables researchers to
            execute complex federated queries by linking well-known, curated and
            widely used biological data resources, and supplementary TB variants
            data from published literature.
          </p>
        </div>
        <div class="paragraph">
          <p class="lead">
            The next slide contains example queries that can be execute in the
            Neo4j browser.
          </p>
        </div>
      </div>
    </slide>
    <slide class="row-fluid">
      <div class="col-sm-12">
        <h3>Explore NeoDB</h3>
        <br />
        <div>
          <div class="col-lg-3 ng-scope">
            <h4>Label counts</h4>
            <br />
            <div class="paragraph">
              <p class="lead">
                In Neo4j, node types are called labels. The following query
                counts the number of nodes per label. Run it by clicking the
                text box to prefill the command and then hitting
                <a tooltip-placement="left" class="circled play sl sl-play"></a>
                in the upper right.
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="pre-scrollable code runnable">
MATCH(node) 
RETURN head(labels(node)) AS label, count(*) AS count 
ORDER BY count DESC</pre
                >
              </div>
            </div>
          </div>
          <div class="col-lg-3 ng-scope">
            <h4>Relationship type counts</h4>
            <br />
            <div class="paragraph">
              <p class="lead">
                Play the following query to count the number of relationships
                per type.
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="pre-scrollable code runnable">
MATCH()-[rel]->() 
RETURN type(rel) AS rel_type, 
count(*) AS count 
ORDER BY count DESC</pre
                >
              </div>
            </div>
          </div>
          <div class="col-lg-6 ng-scope">
            <h4>Random relationships</h4>
            <br />
            <div class="paragraph">
              <p class="lead">
                The following query retrieves a random relationship of each
                type. The query goes through every relationship and thus may
                take several seconds.
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="pre-scrollable code runnable">
MATCH()-[rel]->() WITH type(rel) AS rel_type, collect(rel) AS rels
WITH rels[toInteger(rand() * size(rels))] AS rel RETURN startNode(rel), rel, endNode(rel)</pre
                >
              </div>
            </div>
            <div class="paragraph">
              <p class="lead">
                By default, the NeoDB Neo4j Browser only shows relationships
                that were returned by the query. To show every relationship
                between the displayed nodes instead, select
                <code>Connect result nodes</code> under settings.
              </p>
            </div>
          </div>
        </div>
      </div>
    </slide>
    <slide class="row-fluid">
      <div class="col-sm-4">
        <h3>Querying the COMBAT-TB NeoDB</h3>
        <!-- <p class="lead">Example queries</p> -->
        <br />
        <div class="imageblock">
          <div class="content">
            <img
              src="https://raw.githubusercontent.com/COMBAT-TB/combattbmodel/master/docs/chado_based_graph_model.png"
              alt="NeoDB graph model"
            />
          </div>
        </div>
      </div>
      <div class="col-sm-8">
        <div class="paragraph">
          <p class="lead">Getting the Schema</p>
        </div>
        <figure>
          <pre class="pre-scrollable code runnable">
call db.schema.visualization</pre
          >
          <!-- <figcaption>Find the produce suppliers.</figcaption> -->
        </figure>
        <div class="paragraph">
          <p class="lead">
            Find genes that encode proteins, limiting to results to 25
          </p>
        </div>
        <figure>
          <pre class="pre-scrollable code runnable">
MATCH(g:Gene)-[r:ENCODES]->(p:Protein) RETURN g.name as gene, p.name as protein LIMIT 25</pre
          >
        </figure>
        <div class="paragraph">
          <p class="lead">
            Which genes encode a protein that interacts with a known drug target
          </p>
        </div>
        <figure>
          <pre class="pre-scrollable code runnable">
MATCH(gene)-[:ENCODES]-(p1:Protein)-[:INTERACTS_WITH]-(p2:Protein)-[:TARGET]-(drug:Drug) RETURN *</pre
          >
        </figure>
        <div class="paragraph">
          <p class="lead">
            Find a drugs that targets a set of proteins.
          </p>
        </div>
        <figure>
          <pre class="pre-scrollable code runnable">
MATCH(p:Protein)-[:TARGET]-(drug) WITH drug, count(p) AS ProteinSetSize, collect(protein.uniquename) AS ProteinSet 
WHERE ProteinSetSize > 1 RETURN drug.name AS DrugName, drug.accession AS DrugAcc, ProteinSet, ProteinSetSize ORDER BY ProteinSetSize DESC</pre
          >
        </figure>
      </div>
    </slide>
  </carousel>
</article>
